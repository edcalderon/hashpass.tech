<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="theme-color" content="#1D9BF0">
    <title>BSL 2025</title>
    <link rel="icon" href="/favicon.ico" />
    <link rel="apple-touch-icon" href="/apple-touch-icon.png" />
    <link rel="manifest" href="/manifest.json" />
    <style>
        :root {
            --primary-color: #1D9BF0;
            --background-color: #f5f5f5;
            --text-color: #1a1a1a;
            --text-secondary: #666;
        }
        
        body, html {
            margin: 0;
            padding: 0;
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            background-color: var(--background-color);
            color: var(--text-color);
            overflow: hidden;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }
        
        .loader {
            text-align: center;
            padding: 2rem;
            max-width: 90%;
            margin: 0 auto;
        }
        
        .logo {
            width: 120px;
            height: 120px;
            margin-bottom: 1.5rem;
            animation: pulse 2s infinite;
        }
        
        h1 {
            font-size: 2rem;
            margin: 1rem 0 0.5rem;
            color: var(--text-color);
            font-weight: 600;
        }
        
        p {
            color: var(--text-secondary);
            font-size: 1.1rem;
            margin: 0.5rem 0 2rem;
            max-width: 80%;
            text-align: center;
            line-height: 1.5;
        }
        
        .progress-container {
            width: 200px;
            height: 4px;
            background-color: rgba(0, 0, 0, 0.1);
            border-radius: 2px;
            overflow: hidden;
            margin: 1rem 0;
        }
        
        .progress-bar {
            height: 100%;
            width: 0;
            background-color: var(--primary-color);
            transition: width 0.3s ease;
            animation: progress 2s ease-in-out infinite;
        }
        
        @keyframes pulse {
            0% { transform: scale(0.95); opacity: 0.8; }
            50% { transform: scale(1.05); opacity: 1; }
            100% { transform: scale(0.95); opacity: 0.8; }
        }
        
        @keyframes progress {
            0% { width: 0; margin-left: 0; }
            50% { width: 100%; margin-left: 0; }
            100% { width: 0; margin-left: 100%; }
        }
        
        @media (prefers-color-scheme: dark) {
            :root {
                --background-color: #121212;
                --text-color: #ffffff;
                --text-secondary: #b0b0b0;
            }
        }
    </style>
</head>
<body>
    <div class="loader">
        <div class="logo">
            <svg width="120" height="120" viewBox="0 0 120 120" fill="none" xmlns="http://www.w3.org/2000/svg">
                <circle cx="60" cy="60" r="55" fill="#1D9BF0" fill-opacity="0.1"/>
                <path d="M60 20C38.4 20 20 38.4 20 60C20 81.6 38.4 100 60 100C81.6 100 100 81.6 100 60C100 38.4 81.6 20 60 20ZM60 90C44.5 90 30 78.5 30 60C30 41.5 44.5 30 60 30C75.5 30 90 41.5 90 60C90 78.5 75.5 90 60 90Z" fill="#1D9BF0"/>
                <path d="M60 40C49 40 40 49 40 60C40 71 49 80 60 80C71 80 80 71 80 60C80 49 71 40 60 40ZM60 70C54.5 70 50 65.5 50 60C50 54.5 54.5 50 60 50C65.5 50 70 54.5 70 60C70 65.5 65.5 70 60 70Z" fill="#1D9BF0"/>
            </svg>
        </div>
        <h1>BSL 2025</h1>
        <p>Loading your experience...</p>
        <div class="progress-container">
            <div class="progress-bar"></div>
        </div>
    </div>

    <script>
    // Enhanced script loading with retries and better error handling
    (function() {
        const paths = [
            '/static/js/bundle.js',
            '/_expo/static/js/bundle.js',
            '/_next/static/chunks/main.js',
            '/bundle.js',
            '/main.js',
            '/static/js/main.chunk.js',
            '/_next/static/chunks/webpack.js',
            '/static/js/2.chunk.js',
            '/static/js/main.js'
        ];

        const MAX_RETRIES = 3;
        let retryCount = 0;
        let currentPathIndex = 0;

        function updateStatus(message) {
            console.log(`[BSL2025] ${message}`);
            const statusEl = document.querySelector('p');
            if (statusEl) {
                statusEl.textContent = message;
            }
        }

        function loadScript(src) {
            return new Promise((resolve, reject) => {
                const script = document.createElement('script');
                script.src = src;
                script.onload = () => {
                    console.log(`[BSL2025] Successfully loaded: ${src}`);
                    resolve();
                };
                script.onerror = () => {
                    console.warn(`[BSL2025] Failed to load: ${src}`);
                    reject();
                };
                document.body.appendChild(script);
            });
        }

        async function tryLoadNextScript() {
            if (currentPathIndex >= paths.length) {
                if (retryCount < MAX_RETRIES) {
                    retryCount++;
                    currentPathIndex = 0;
                    updateStatus(`Retrying to load application (${retryCount}/${MAX_RETRIES})...`);
                    await new Promise(resolve => setTimeout(resolve, 1000 * retryCount));
                    return tryLoadNextScript();
                } else {
                    updateStatus('Failed to load application. Please refresh the page or try again later.');
                    console.error('[BSL2025] All script loading attempts failed');
                    return;
                }
            }

            const path = paths[currentPathIndex++];
            updateStatus(`Loading resources... (${currentPathIndex}/${paths.length})`);
            
            try {
                await loadScript(path);
                // If we get here, the script loaded successfully
                return;
            } catch (e) {
                // Try the next path
                return tryLoadNextScript();
            }
        }

        // Start loading scripts
        updateStatus('Preparing your experience...');
        tryLoadNextScript().catch(console.error);

        // Handle service worker registration
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('/sw.js')
                    .then(registration => {
                        console.log('[BSL2025] ServiceWorker registration successful');
                    })
                    .catch(err => {
                        console.warn('[BSL2025] ServiceWorker registration failed: ', err);
                    });
            });
        }
    })();
    </script>
</body>
</html>
